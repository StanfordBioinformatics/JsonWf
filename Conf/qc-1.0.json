{ 

	"resources": {
		"reference": "/srv/gs1/projects/scg/Resources/GATK/hg19/ucsc.hg19.fasta",
    "dbsnp": "/srv/gs1/projects/scg/Resources/GATK/hg19-3.0/dbsnp_138.hg19.vcf",
    "GATK": "/srv/gs1/software/GATK/GATK-3.0/GenomeAnalysisTK-3.0-0/",
    "PICARD": "/srv/gs1/software/PICARD-tools/1.111",
    "refseq_exons": "/srv/gsfs0/projects/gbsc/Clinical_Service/dbases/refSeq/refseq_exons.bed",
    "rModule": "r",
    "javaModule": "java/latest",
		"samtoolsModule": "samtools/0.1.19",

	  "qsub": {
			"-M": "aminzia@stanford.edu",
     	"-m": "a",
    	"-A": "clinical-services",
      "-R": "y"
		}
  },
	
	"analyses": [

		{
			"analysis": "fastqc",
			"description": "FASTQC tool from Babraham Bioinformatics",
			"program": "fastqc",
			"enable": 1,
			"modules": ["fastqc/0.10.1"],
			"inputFormat": "bam",

			"outdirs": [
				{"d_fastqc": "${outdir}/fastqc"}
			],

			"qsub": {
				"name": "FastQC",
				"mem": "1G"
			},
		
			"params": {
				"--threads": 5,
				"--outdir": "${d_fastqc}"
			},
		
			"args": ["${bam}"]
		},

		{   
			"analysis": "GATK_flagstat",
			"description": "GATK's flagstat",
			"enable": 1,
			"modules": ["${javaModule}"],
			"jar": "${GATK}/GenomeAnalysisTK.jar",
			"javavm": "-Xmx5G",
			"inputFormat": "bam",
    
      "outdirs": [
        {"d_GATK_flagstat": "${outdir}/gatk_flagstat"}
      ],  

      "outfiles": [
        {"f_GATK_flagstat": "${d_GATK_flagstat}/flagstat.txt"}
      ],  
    
      "qsub": {
        "name": "GATK_flagstat",
        "slots": 1,
        "mem": "10G"
      },  
    
      "params": {
        "-T": "FlagStat",
        "-R": "${reference}",
        "-I": "${bam}",
        "-o": "${f_GATK_flagstat}"
      }   
		},  

    {
      "analysis": "samtools_flagstat",
      "description": "samtools flagstat",
      "program": "samtools flagstat",
      "enable": 1,
      "modules": ["${samtoolsModule}"],
      "inputFormat": "bam",

      "outdirs": [
        {"d_samtools_flagstat": "${outdir}/samtools_flagstat"}
      ],

      "outfiles": [
        {"f_samtools_flagstat": "${d_samtools_flagstat}/flagstat.txt"}
      ],

      "qsub": {
        "name": "samtools_flagstat",
        "slots": 1,
        "mem": "3G"
      },

      "args": ["${bam}",">","${f_samtools_flagstat}"]
    },

		{
			"analysis": "DepthOfCoverageRefseqExonsQ0",
      "description": "GATK's DepthOfCoverage of >= Q0 bases over RefSeq exons",
      "enable": 1,
      "modules": ["${javaModule}"],
      "jar": "${GATK}/GenomeAnalysisTK.jar",
      "javavm": "-Xmx5G",
      "inputFormat": "bam",

      "qsub": {
	      "name": "DepthOfCoverageRefseqExonsQ0",
        "slots": 1,
        "mem": "12G"
      },

      "outdirs": [            
	      {"d_depthOfCoverageRefSeqExonQ0": "${outdir}/coverage"}
      ],

			"outfiles": [
				{"f_depthOfCoverage_refseq_exons_coverage_hist_Q0": "${d_depthOfCoverageRefSeqExonQ0}/refseq_exons_coverage_hist_Q0.txt"}
			],

      "params": {
				"-T": "DepthOfCoverage",
        "-L": "${refseq_exons}",
        "-R": "${reference}",
        "-I": "${bam}",
        "--summaryCoverageThreshold": "10",
				"-o": "${f_depthOfCoverage_refseq_exons_coverage_hist_Q0}"
      }
		},

		{
			"analysis": "DepthOfCoverageRefseqExonsQ10",
      "description": "GATK's DepthOfCoverage of >= Q10 bases over RefSeq exons",
      "enable": 1,
      "modules": ["${javaModule}"],
      "jar": "${GATK}/GenomeAnalysisTK.jar",
      "javavm": "-Xmx5G",
      "inputFormat": "bam",

      "qsub": {
	      "name": "DepthOfCoverageRefseqExonsQ10",
        "slots": 1,
        "mem": "12G"
      },

      "outdirs": [
        {"d_depthOfCoverageRefSeqExonQ10": "${outdir}/coverage"}
      ],

      "outfiles": [
        {"f_depthOfCoverage_refseq_exons_coverage_hist_Q10": "${d_depthOfCoverageRefSeqExonQ10}/refseq_exons_coverage_hist_Q10.txt"}
      ],

			"params": {
        "-T": "DepthOfCoverage",
        "-L": "${refseq_exons}",
        "-R": "${reference}",
        "-I": "${bam}",
				"-mbq": "10",
				"--summaryCoverageThreshold": "10",
        "-o": "${f_depthOfCoverage_refseq_exons_coverage_hist_Q10}"
			}
		},

		{
			"analysis": "DepthOfCoverageRefseqExonsQ20",
      "description": "GATK's DepthOfCoverage of >= Q20 bases over RefSeq exons",
      "enable": 1,
      "modules": ["${javaModule}"],
      "jar": "${GATK}/GenomeAnalysisTK.jar",
      "javavm": "-Xmx5G",
      "inputFormat": "bam",

      "qsub": {
        "name": "DepthOfCoverageRefseqExonsQ20",
        "slots": 1,
        "mem": "12G"
      },

			"outdirs": [
        {"d_depthOfCoverageRefSeqExonQ20": "${outdir}/coverage"}
			],

			"outfiles": [
				{"f_depthOfCoverage_refseq_exons_coverage_hist_Q20": "${d_depthOfCoverageRefSeqExonQ20}/refseq_exons_coverage_hist_Q20.txt"}
			],

      "params": {
        "-T": "DepthOfCoverage",
        "-L": "${refseq_exons}",
        "-R": "${reference}",
        "-I": "${bam}",
				"-mbq": "20",
        "--summaryCoverageThreshold": "10",
        "-o": "${f_depthOfCoverage_refseq_exons_coverage_hist_Q20}"
      }
		},

		{
			"analysis": "DepthOfCoverageRefseqExonsQ30",
       "description": "GATK's DepthOfCoverage of >= Q30 bases over RefSeq exons",
       "enable": 1,
       "modules": ["${javaModule}"],
       "jar": "${GATK}/GenomeAnalysisTK.jar",
       "javavm": "-Xmx5G",
       "inputFormat": "bam",

       "qsub": {
         "name": "DepthOfCoverageRefseqExonsQ30",
         "slots": 1,
         "mem": "12G"
       },

       "outdirs": [
         {"d_depthOfCoverageRefSeqExonQ30": "${outdir}/coverage"}
       ],

			"outfiles": [
				{"f_depthOfCoverage_refseq_exons_coverage_hist_Q30": "${d_depthOfCoverageRefSeqExonQ30}/refseq_exons_coverage_hist_Q30.txt"}
       ],

      "params": {
        "-T": "DepthOfCoverage",
        "-L": "${refseq_exons}",
        "-R": "${reference}",
        "-I": "${bam}",
				"-mbq": "30",
        "--summaryCoverageThreshold": "10",
        "-o": "${f_depthOfCoverage_refseq_exons_coverage_hist_Q30}"
      }
		},

		{
			"analysis": "DepthOfCoverageGenomeQ0",
      "description": "GATK's DepthOfCoverage of >= Q0 bases",
      "enable": 1,
      "modules": ["${javaModule}"],
      "jar": "${GATK}/GenomeAnalysisTK.jar",
      "javavm": "-Xmx5G",
      "inputFormat": "bam",

      "qsub": {
        "name": "DepthOfCoverageGenomeQ0",
        "slots": 1,
        "mem": "12G"
      },

      "outdirs": [
        {"d_depthOfCoverageGenomeQ0": "${outdir}/coverage"}
      ],

      "outfiles": [
        {"f_depthOfCoverage_genome_coverage_hist_Q0": "${d_depthOfCoverageGenomeQ0}/genome_coverage_hist_Q0.txt"}
      ],

      "params": {
        "-T": "DepthOfCoverage",
        "-R": "${reference}",
        "-I": "${bam}",
        "--summaryCoverageThreshold": "10",
        "-o": "${f_depthOfCoverage_genome_coverage_hist_Q0}"
			}
		},

		{
			"analysis": "DepthOfCoverageGenomeQ10",
      "description": "GATK's DepthOfCoverage of >= Q10 bases",
       "enable": 1,
       "modules": ["${javaModule}"],
       "jar": "${GATK}/GenomeAnalysisTK.jar",
       "javavm": "-Xmx5G",
       "inputFormat": "bam",

       "qsub": {
         "name": "DepthOfCoverageGenomeQ10",
         "slots": 1,
         "mem": "12G"
       },

       "outdirs": [
         {"d_depthOfCoverageGenomeQ10": "${outdir}/coverage"}
       ],

       "outfiles": [
         {"f_depthOfCoverage_genome_coverage_hist_Q10": "${d_depthOfCoverageGenomeQ10}/genome_coverage_hist_Q10.txt"}
       ],

			"params": {
        "-T": "DepthOfCoverage",
        "-R": "${reference}",
        "-I": "${bam}",
				"-mbq": "10",
        "--summaryCoverageThreshold": "10",
        "-o": "${f_depthOfCoverage_genome_coverage_hist_Q10}"
      }
		},

		{
			"analysis": "DepthOfCoverageGenomeQ20",
      "description": "GATK's DepthOfCoverage of >= Q20 bases",
      "enable": 1,
      "modules": ["${javaModule}"],
      "jar": "${GATK}/GenomeAnalysisTK.jar",
      "javavm": "-Xmx5G",
      "inputFormat": "bam",

      "qsub": {
        "name": "DepthOfCoverageGenomeQ20",
        "slots": 1,
        "mem": "12G"
      },

      "outdirs": [
        {"d_depthOfCoverageGenomeQ20": "${outdir}/coverage"}
      ],

			"outfiles": [
        {"f_depthOfCoverage_genome_coverage_hist_Q20": "${d_depthOfCoverageGenomeQ20}/genome_coverage_hist_Q20.txt"}
      ],

			"params": {
        "-T": "DepthOfCoverage",
        "-R": "${reference}",
        "-I": "${bam}",
				"-mbq": "20",
        "--summaryCoverageThreshold": "10",
        "-o": "${f_depthOfCoverage_genome_coverage_hist_Q20}"
       }
		},

		{
			"analysis": "DepthOfCoverageGenomeQ30",
      "description": "GATK's DepthOfCoverage of >= Q30 bases",
      "enable": 1,
      "modules": ["${javaModule}"],
      "jar": "${GATK}/GenomeAnalysisTK.jar",
      "javavm": "-Xmx5G",
      "inputFormat": "bam",

      "qsub": {
        "name": "DepthOfCoverageGenomeQ30",
        "slots": 1,
        "mem": "12G"
      },

      "outdirs": [
        {"d_depthOfCoverageGenomeQ30": "${outdir}/coverage"}
      ],

      "outfiles": [
        {"f_depthOfCoverage_genome_coverage_hist_Q30": "${d_depthOfCoverageGenomeQ30}/genome_coverage_hist_Q30.txt"}
      ],

      "params": {
        "-T": "DepthOfCoverage",
        "-R": "${reference}",
        "-I": "${bam}",
				"-mbq": "30",
        "--summaryCoverageThreshold": "10",
        "-o": "${f_depthOfCoverage_genome_coverage_hist_Q30}"
			}
		},

		{
			"analysis": "Concordance",
			"description": "GATK's SelectVariants; outputs VCF file containing concordant records",
			"enable": 1,
			"modules": ["${javaModule}"],
			"jar": "${GATK}/GenomeAnalysisTK.jar",
			"javavm": "-Xmx2G",
			"inputFormat": "vcf",

			"outdirs": [
				{"d_concordance": "${outdir}/concordance"}
			],

			"outfiles": [
				{"f_concordance": "${d_concordance}/concordance.vcf"}
			],

			"qsub": {
				"name": "SelectVariants_concordance",
				"slots": 8,
				"mem": "2G"
			},

			"params": {
				"-T": "SelectVariants",
				"-L": "${refseq_exons}",
				"-nt": 8,
				"--variant": "${vcf}",
				"--concordance": "${dbsnp}",
				"-R": "${reference}",
				"-o": "${f_concordance}"
			}
		},

		{
			"analysis": "Discordance",
			"description": "GATK's SelectVariants; outputs VCF file containing discordant records",
			"enable": 1,
			"modules": ["${javaModule}"],
			"jar": "${GATK}/GenomeAnalysisTK.jar",
			"javavm": "-Xmx2G",
			"inputFormat": "vcf",

			"outdirs": [
				{"d_discordance": "${outdir}/discordance"}
			],

			"outfiles": [
				{"f_discordance": "${d_discordance}/discordance.vcf"}
			],

			"qsub": {
				"name": "SelectVariants_discordance",
				"slots": 8,
				"mem": "2G"
			},

			"params": {
				"-T": "SelectVariants",
				"-L": "${refseq_exons}",
				"-nt" : 8,
				"--variant": "${vcf}",
				"--discordance": "${dbsnp}",
				"-R": "${reference}",
				"-o": "${f_discordance}"
			}
		},

		{
			"analysis": "VariantEval",
			"description": "GATK's VariantEval",
			"enable": 1,
			"modules": ["${javaModule}"],
			"jar": "${GATK}/GenomeAnalysisTK.jar",
			"javavm": "-Xmx2G",
			"inputFormat": "vcf",

			"outdirs": [
				{"d_variantEval": "${outdir}/variantEval"}
			],

			"outfiles": [
				{"f_variantEval": "${d_variantEval}/variantEval_metrics.txt"}
			],

			"qsub": {
				"name": "VariantEval",
				"slots": 1,
				"mem": "6G"
			},

			"params": {
				"-nt": 8,
				"-T": "VariantEval",
				"-L": "${refseq_exons}",
				"-R": "${reference}",
				"--eval:set1,vcf": "${vcf}",
				"-o": "${f_variantEval}",
				"-noEV": "",
				"-EV CountVariants -EV TiTvVariantEvaluator": "",
				"-noST": "",
				"-ST": "VariantType",
				"--dbsnp": "${dbsnp}"
			}
		},

		{
			"analysis": "GenotypeConcordance",
			"description": "GATK's GenotypeConcordance",
			"enable": 1,
			"modules": ["${javaModule}"],
			"jar": "${GATK}/GenomeAnalysisTK.jar",
			"javavm": "-Xmx2G",
			"inputFormat": "vcf",

			"outdirs": [
				{"d_genotypeConcordance": "${outdir}/gtConcordance"}
			],

			"outfiles": [
				{"f_genotypeConcordance": "${d_genotypeConcordance}/gtConcordance.txt"}
			],

			"qsub": {
				"name": "GenotypeConcordance",
				"slots": 1,
				"mem": "6G"
			},

			"params": {
				"-T": "GenotypeConcordance",
				"-R": "${reference}",
				"--eval:set1,vcf": "${vcf}",
				"-o": "${f_genotypeConcordance}",
				"--comp": "${dbsnp}"
			}
		},

		{
			"analysis": "CollectAlignmentSummaryMetrics",
			"description": "Picard's CollectAlignmentSummaryMetrics",
			"enable": 1,
			"modules": ["${javaModule}"],
			"jar": "${PICARD}/CollectAlignmentSummaryMetrics.jar",
			"javavm": "-Xmx4G",
			"inputFormat": "bam",

			"outdirs": [
				{"d_collectAlignmentSummaryMetrics": "${outdir}/alnSumMetrics"}
			],
			
			"outfiles": [
				{"f_collectAlignmentSummaryMetrics": "${d_collectAlignmentSummaryMetrics}/alnSummaryMetrics.txt"}
			],

			"qsub": {
				"name": "CollectAlignmentSummaryMetrics",
				"slots": 1,
				"mem": "8G"
			},
		
			"params": {
				"ASSUME_SORTED=": "true",
				"INPUT=": "${bam}",
				"OUTPUT=": "${f_collectAlignmentSummaryMetrics}",
				"REFERENCE_SEQUENCE=": "${reference}",
				"METRIC_ACCUMULATION_LEVEL=": "ALL_READS"
			}
		},

		{
			"analysis": "CollectGcBiasMetrics",
			"description": "Picards CollectGcBiasMetrics",
			"enable": 1,
			"modules": ["${javaModule}","${rModule}"],
			"jar": "${PICARD}/CollectGcBiasMetrics.jar",
			"javavm": "-Xmx4G",
			"inputFormat": "bam",

			"outdirs": [
				{"d_collectGcBiasMetrics": "${outdir}/gcBiasMetrics"}
			],

			"outfiles": [
				{"f_collectGcBiasMetrics": "${d_collectGcBiasMetrics}/gcBiasMetrics.txt"},
				{"f_collectGcBiasMetrics_summary": "${d_collectGcBiasMetrics}/gcBiasMetrics_summary.txt"},
				{"f_collectGcBiasMetrics_chart": "${d_collectGcBiasMetrics}/gcBiasMetrics_chart.pdf"}
			],
			
			"qsub": {
				"name": "CollectGcBiasMetrics",
				"slots": 1,
				"mem": "8G"
			},
		
			"params": {
				"ASSUME_SORTED=": "true",
				"INPUT=": "${bam}",
				"OUTPUT=": "${f_collectGcBiasMetrics}",
				"REFERENCE_SEQUENCE=": "${reference}",
				"SUMMARY_OUTPUT=": "${f_collectGcBiasMetrics_summary}",
				"CHART_OUTPUT=": "${f_collectGcBiasMetrics_chart}"
			}
		},

		{
			"analysis": "CollectInsertSizeMetrics",
			"description": "Picard's CollectInsertSizeMetrics",
			"enable": 1,
			"modules": ["${javaModule}","${rModule}"],
			"jar": "${PICARD}/CollectInsertSizeMetrics.jar",
			"javavm": "-Xmx2G",
			"inputFormat": "bam",

			"outdirs": [
				{"d_collectInsertSizeMetrics": "${outdir}/insertSizeMetrics"}
			],
			
			"outfiles": [	
				{"f_collectInsertSizeMetrics": "${d_collectInsertSizeMetrics}/insertSizeMetrics.txt"}
			],
			
			"qsub": {
				"name": "CollectInsertSizeMetrics",
				"slots": 1,
				"mem": "5G"
			},
	
			"params": {
				"ASSUME_SORTED=": "true",
				"INPUT=": "${bam}",
				"OUTPUT=": "${f_collectInsertSizeMetrics}",
				"REFERENCE_SEQUENCE=": "${reference}",
				"METRIC_ACCUMULATION_LEVEL=": "ALL_READS",
				"HISTOGRAM_FILE=": "insertSizeHist.pdf"
			}
		},

		{
			"analysis": "MeanQualityByCycle",
			"description": "Picard's MeanQualityByCycle",
			"enable": 1,
			"modules": ["${javaModule}","${rModule}"],
			"jar": "${PICARD}/MeanQualityByCycle.jar",
			"javavm": "-Xmx2G",
			"inputFormat": "bam",

			"outdirs": [
				{"d_meanQualityByCycle": "${outdir}/meanQualByCycle"}
			],
		
			"outfiles": [
				{"f_meanQualityByCycle": "${d_meanQualityByCycle}/meanQuaByCycle.txt"},
				{"f_meanQualityByCycle_pdf": "${d_meanQualityByCycle}/meanQualByCycle.pdf"}
			],
			
			"qsub": {
				"name": "MeanQualityByCycle",
				"slots": 1,
				"mem": "5G"
			},
	
			"params": {
				"ASSUME_SORTED=": "true",
				"INPUT=": "${bam}",
				"OUTPUT=": "${f_meanQualityByCycle}",
				"REFERENCE_SEQUENCE=": "${reference}",
				"ALIGNED_READS_ONLY=": "true",
				"PF_READS_ONLY=": "true",
				"CHART_OUTPUT=": "${f_meanQualityByCycle_pdf}"
			}
		},

		{
			"analysis": "QualityScoreDistribution",
			"description": "Picard's QualityScoreDistribution",
			"enable": 1,
			"modules": ["${javaModule}","${rModule}"],
			"jar": "${PICARD}/QualityScoreDistribution.jar",
			"javavm": "-Xmx2G",
			"inputFormat": "bam",

			"outdirs": [
				{"d_qualityScoreDistribution": "${outdir}/qcScoreDist"}
			],

			"outfiles": [
				{"f_qualityScoreDistribution": "${d_qualityScoreDistribution}/qualScoreDist.txt"},
				{"f_qualityScoreDistribution_chart": "${d_qualityScoreDistribution}/qualScoreDist_chart.pdf"}
			],
			
			
			"qsub": {
				"name": "QualityScoreDistribution",
				"slots": 1,
				"mem": "5G"
			},
	
			"params": {
				"ASSUME_SORTED=": "true",
				"INPUT=": "${bam}",
				"OUTPUT=": "${f_qualityScoreDistribution}",
				"REFERENCE_SEQUENCE=": "${reference}",
				"ALIGNED_READS_ONLY=": "true",
				"PF_READS_ONLY=": "true",
				"CHART_OUTPUT=": "${f_qualityScoreDistribution_chart}"
			}
		}
	]
}
